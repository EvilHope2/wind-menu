<%- include("../partials/head", { title }) %>
<main class="app-shell">
  <%- include("../partials/app-sidebar", { activePage }) %>
  <section class="app-content">
    <%- include("../partials/flash") %>
    <header class="page-head">
      <div>
        <h1>Zonas de envio</h1>
        <p class="muted">Define barrios, costo de envio y estado activo para cada zona.</p>
      </div>
    </header>

    <section class="card">
      <h2>Nueva zona</h2>
      <form method="post" action="/app/delivery-zones" class="form inline zone-form">
        <input type="text" name="name" placeholder="Nombre de zona/barrio" required />
        <input type="number" step="0.01" min="0" name="price" placeholder="Precio envio (ARS)" required />
        <input type="number" step="1" min="0" name="sort_order" placeholder="Orden" value="0" />
        <label class="checkbox"><input type="checkbox" name="is_active" checked /> Activa</label>
        <button class="btn btn-primary" type="submit">Crear zona</button>
      </form>
    </section>

    <section class="card">
      <h2>Listado de zonas</h2>
      <% if (!zones.length) { %>
        <div class="empty">Todavia no cargaste zonas de envio.</div>
      <% } %>
      <div class="zones-stack">
        <% zones.forEach((zone) => { %>
          <form method="post" action="/app/delivery-zones/<%= zone.id %>/update" class="card zone-card">
            <div class="zone-card-head">
              <h3><%= zone.name %></h3>
              <span class="tag <%= zone.is_active ? 'tag-ok' : '' %>"><%= zone.is_active ? 'Activa' : 'Inactiva' %></span>
            </div>
            <div class="zone-grid">
              <label>Nombre
                <input type="text" name="name" value="<%= zone.name %>" required />
              </label>
              <label>Precio envio (ARS)
                <input type="number" step="0.01" min="0" name="price" value="<%= zone.price %>" required />
              </label>
              <label>Orden
                <input type="number" step="1" min="0" name="sort_order" value="<%= zone.sort_order %>" />
              </label>
              <label class="checkbox"><input type="checkbox" name="is_active" <%= zone.is_active ? 'checked' : '' %> /> Activa</label>
            </div>
            <div class="top-actions">
              <button class="btn btn-ghost" type="submit">Guardar</button>
              <button
                class="btn btn-danger js-confirm"
                data-confirm="Eliminar esta zona de envio?"
                formaction="/app/delivery-zones/<%= zone.id %>/delete"
                type="submit"
              >
                Eliminar
              </button>
            </div>
          </form>
        <% }) %>
      </div>
    </section>
  </section>
</main>
<%- include("../partials/scripts") %>
